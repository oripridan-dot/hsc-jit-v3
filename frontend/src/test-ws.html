<!DOCTYPE html>
<html>
<head><title>WebSocket Test</title></head>
<body>
<h1>WebSocket Connection Test</h1>
<div id="status">Connecting...</div>
<input id="input" placeholder="Type to test..." style="width: 300px; padding: 10px;">
<div id="results" style="margin-top: 20px; font-family: monospace;"></div>

<script type="module">
// Import the unified state manager
import { unifiedStateManager } from './store/unifiedRouter.ts';

const statusDiv = document.getElementById('status');
const resultsDiv = document.getElementById('results');
const input = document.getElementById('input');

// Subscribe to predictions
unifiedStateManager.subscribe('predictions', (products) => {
  resultsDiv.innerHTML = `<div style="color: green;">✅ Got ${products.length} predictions</div>`;
  products.slice(0, 5).forEach(p => {
    resultsDiv.innerHTML += `<div>• ${p.name} (${p.brand})</div>`;
  });
});

// Test typing
input.addEventListener('input', (e) => {
  const text = e.target.value;
  unifiedStateManager.sendTyping(text);
  statusDiv.textContent = `Sent: "${text}"`;
  statusDiv.style.color = 'blue';
});

setTimeout(() => {
  statusDiv.textContent = 'Connected - Type something!';
  statusDiv.style.color = 'green';
}, 1000);
</script>
</body>
</html>
