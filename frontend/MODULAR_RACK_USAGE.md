# Modular Rack System - Implementation & Usage Guide\n\n## Quick Start\n\n### For End Users\n\n1. **Select a Category**\n `\n   Navigate to any category (Keys, Drums, etc.)\n   `\n\n2. **Switch to Rack View**\n `\n   Click the üéõÔ∏è Rack button in the toolbar (purple highlight)\n   `\n\n3. **Explore Modules**\n `\n   Each subcategory = one rack module\n   Modules stack vertically like a synthesizer\n   `\n\n4. **Hover to Preview**\n `\n   Move mouse over any ‚óè hotspot\n   Rich data screen appears above\n   Shows: Price, Category, Brand, Model, Description\n   `\n\n5. **Select Product**\n `\n   Click any hotspot\n   Product details appear in workbench view\n   `\n\n---\n\n## For Developers\n\n### Adding the Rack System to a View\n\n`tsx\nimport { ModularRack } from '@/components/smart-views/ModularRack';\n\n// In your component:\nconst subcategories = [\n  {\n    name: 'Digital Pianos',\n    products: [...],\n    icon: 'üéπ',\n    color: 'from-blue-600 to-blue-700'\n  },\n  {\n    name: 'Synthesizers',\n    products: [...],\n    icon: 'üåä',\n    color: 'from-purple-600 to-purple-700'\n  },\n  // ... more subcategories\n];\n\nreturn (\n  <ModularRack\n    categoryName=\"Keys & Pianos\"\n    subcategories={subcategories}\n  />\n);\n`\n\n### Using RackModule Directly\n\n`tsx\nimport { RackModule } from '@/components/smart-views/RackModule';\n\n<RackModule\n  subcategoryName=\"Digital Pianos\"\n  products={products}\n  icon=\"üéπ\"\n  color=\"from-blue-600 to-blue-700\"\n/>\n`\n\n### Props Reference\n\n**RackModule**\n\n`tsx\ninterface RackModuleProps {\n  // Required\n  subcategoryName: string;      // Display name\n  products: Product[];           // Array of products\n  \n  // Optional\n  icon?: React.ReactNode;        // React component or emoji\n  color?: string;                // Tailwind gradient class\n  className?: string;            // Additional CSS classes\n}\n`\n\n**ModularRack**\n\n`tsx\ninterface ModularRackProps {\n  // Required\n  categoryName: string;           // Main category name\n  subcategories: Array<{          // Array of subcategory specs\n    name: string;                 // Subcategory name\n    products: Product[];          // Products in this subcategory\n    icon?: React.ReactNode;       // Optional icon\n    color?: string;               // Optional color\n  }>;\n  \n  // Optional\n  className?: string;             // Additional CSS classes\n}\n`\n\n---\n\n## Integration Examples\n\n### Example 1: Category View (Already Integrated)\n\n`tsx\n// In UniversalCategoryView.tsx\n\n{viewMode === 'rack' && shelfNames.length > 0 && (\n  <div className=\"pt-48\">\n    <ModularRack\n      categoryName={activeCategory}\n      subcategories={shelfNames.map((name) => ({\n        name,\n        products: shelves[name],\n        // Optional: Add icons and colors per category\n        icon: getCategoryIcon(name),\n        color: getCategoryColor(name),\n      }))}\n    />\n  </div>\n)}\n`\n\n### Example 2: Brand-Specific View\n\n`tsx\n// Displaying products from a single brand\n\nimport { ModularRack } from '@/components/smart-views/ModularRack';\nimport { useBrandCatalog } from '@/hooks/useBrandCatalog';\n\nfunction RolandCatalogView() {\n  const { catalog } = useBrandCatalog('roland');\n  \n  // Group products by family\n  const families = groupBy(catalog.products, 'family');\n  \n  return (\n    <ModularRack\n      categoryName=\"Roland Instruments\"\n      subcategories={Object.entries(families).map(([name, products]) => ({\n        name,\n        products,\n        color: 'from-red-600 to-red-700', // Roland brand color\n      }))}\n    />\n  );\n}\n`\n\n### Example 3: Dynamic Color Assignment\n\n`tsx\n// Assign colors based on category\n\nconst CATEGORY_COLORS = {\n  'Keys & Pianos': 'from-blue-600 to-blue-700',\n  'Drums & Percussion': 'from-amber-600 to-amber-700',\n  'Guitars & Amps': 'from-orange-600 to-orange-700',\n  'Studio & Recording': 'from-slate-600 to-slate-700',\n  'Live Sound': 'from-lime-600 to-lime-700',\n  'DJ & Production': 'from-fuchsia-600 to-fuchsia-700',\n};\n\nconst getSubcategoryColor = (subcategName: string): string => {\n  // Default to category color if available\n  return CATEGORY_COLORS[subcategName] || 'from-zinc-600 to-zinc-700';\n};\n\nsubcategories={shelfNames.map((name) => ({\n  name,\n  products: shelves[name],\n  color: getSubcategoryColor(name),\n}))}\n`\n\n---\n\n## Styling Customization\n\n### Module Colors (Tailwind Gradients)\n\n`tsx\n// Brand-specific colors\ncolor=\"from-red-600 to-red-700\"      // Roland\ncolor=\"from-blue-600 to-blue-700\"    // Boss\ncolor=\"from-teal-600 to-teal-700\"    // Nord\ncolor=\"from-amber-600 to-amber-700\"  // Moog\n\n// Category colors\ncolor=\"from-purple-600 to-purple-700\" // Software\ncolor=\"from-green-600 to-green-700\"   // Accessories\n`\n\n### Overriding Component Styles\n\n`tsx\n// Add custom className to wrapper\n<RackModule\n  subcategoryName=\"Custom Module\"\n  products={products}\n  className=\"shadow-2xl border-2 border-cyan-500/50\"\n/>\n\n// Wrap ModularRack with custom container\n<div className=\"bg-gradient-to-b from-black to-zinc-900\">\n  <ModularRack {...props} />\n</div>\n`\n\n---\n\n## State Management\n\n### Accessing Selected Product\n\n`tsx\n// In any component\nimport { useNavigationStore } from '@/store/navigationStore';\n\nfunction MyComponent() {\n  const { selectedProduct } = useNavigationStore();\n  \n  if (selectedProduct) {\n    console.log('User selected:', selectedProduct.name);\n  }\n}\n`\n\n### Triggering Selection Programmatically\n\n`tsx\nconst { selectProduct } = useNavigationStore();\n\nconst handleCustomSelection = (product: Product) => {\n  selectProduct(product);\n  // Product is now available globally\n};\n`\n\n---\n\n## Data Requirements\n\n### Minimum Product Data for HoverScreen\n\nFor optimal HoverScreen display, products should include:\n\n`tsx\ninterface Product {\n  id: string;              // Required for hotspot key\n  name: string;            // Displayed in HoverScreen title\n  image_url?: string;      // Product image\n  images?: {               // Alternative image format\n    main?: string;\n    thumbnail?: string;\n  };\n  halilit_price?: number;  // Price display\n  pricing?: {\n    regular_price?: number;\n  };\n  category?: string;       // Displayed in specs\n  brand?: string;          // Displayed in specs\n  model_number?: string;   // Technical identifier\n  description?: string;    // Description snippet\n}\n`\n\n### Handling Missing Data\n\nThe HoverScreen gracefully handles missing fields:\n\n`tsx\n// Price section only shows if price exists\n{(product.halilit_price || product.pricing?.regular_price) && (\n  <div>Price: ‚Ç™{price}</div>\n)}\n\n// Category, brand, model all optional\n// Component only renders sections with data\n`\n\n---\n\n## Performance Tips\n\n### 1. Optimize Product Lists\n\n`tsx\n// Filter out products with no images (if desired)\nconst visibleProducts = products.filter(\n  p => p.image_url || p.images\n);\n`\n\n### 2. Memoize Subcategories\n\n`tsx\nimport { useMemo } from 'react';\n\nconst subcategories = useMemo(\n  () => buildSubcategories(products),\n  [products]\n);\n`\n\n### 3. Virtualize Large Lists\n\nFor 1000+ hotspots:\n\n`tsx\n// Consider virtualization\nimport { useVirtualizer } from '@tanstack/react-virtual';\n\n// Only render visible hotspots in viewport\n`\n\n### 4. Lazy Load Images\n\n`tsx\n// Use native lazy loading\n<img\n  src={imageSrc}\n  alt={product.name}\n  loading=\"lazy\"\n/>\n`\n\n---\n\n## Testing\n\n### Unit Tests Example\n\n`tsx\nimport { render, screen, fireEvent } from '@testing-library/react';\nimport { RackModule } from '@/components/smart-views/RackModule';\n\ndescribe('RackModule', () => {\n  it('renders subcategory name', () => {\n    render(\n      <RackModule\n        subcategoryName=\"Test Category\"\n        products={[]}\n      />\n    );\n    expect(screen.getByText('TEST CATEGORY')).toBeInTheDocument();\n  });\n\n  it('displays correct hotspot count', () => {\n    const products = [{id: '1', name: 'Product 1'}, ...];\n    render(\n      <RackModule\n        subcategoryName=\"Test\"\n        products={products}\n      />\n    );\n    expect(screen.getByText('3 units')).toBeInTheDocument();\n  });\n\n  it('shows HoverScreen on hotspot hover', async () => {\n    const { container } = render(\n      <RackModule\n        subcategoryName=\"Test\"\n        products={[{id: '1', name: 'Product 1'}]}\n      />\n    );\n    const hotspot = container.querySelector('button');\n    fireEvent.mouseEnter(hotspot!);\n    expect(await screen.findByText('Product 1')).toBeInTheDocument();\n  });\n});\n`\n\n### Integration Tests Example\n\n`tsx\nimport { render, screen } from '@testing-library/react';\nimport { UniversalCategoryView } from '@/components/views/UniversalCategoryView';\n\ndescribe('Rack View Integration', () => {\n  it('shows rack view button', () => {\n    render(<UniversalCategoryView />);\n    expect(screen.getByTitle('Rack Modular View')).toBeInTheDocument();\n  });\n\n  it('displays ModularRack when rack view selected', () => {\n    render(<UniversalCategoryView />);\n    const rackButton = screen.getByText('üéõÔ∏è Rack');\n    fireEvent.click(rackButton);\n    // Verify ModularRack is rendered\n  });\n});\n`\n\n---\n\n## Troubleshooting\n\n### Issue: HoverScreen doesn't appear\n\n**Check:**\n- Hotspot has `onMouseEnter` handler\n- `hoverScreenData` state is updating\n- `AnimatePresence` is wrapping HoverScreen\n- Z-index (should be z-50)\n\n### Issue: Hotspots not clickable\n\n**Check:**\n- `onClick` handler is attached to button\n- `selectProduct` is properly imported\n- Product has valid `id`\n- Navigation store is initialized\n\n### Issue: Animations not smooth\n\n**Check:**\n- Framer Motion imported correctly\n- Device supports GPU acceleration\n- No heavy computations in render\n- Check browser DevTools performance tab\n\n### Issue: Module doesn't show products\n\n**Check:**\n- Products array is not empty\n- Products have required `id` and `name` fields\n- Products passed to component correctly\n- Check console for errors\n\n---\n\n## Browser Support\n\n| Browser | Version | Status |\n|---------|---------|--------|\n| Chrome | 90+ | ‚úÖ Full support |\n| Firefox | 88+ | ‚úÖ Full support |\n| Safari | 14+ | ‚úÖ Full support |\n| Edge | 90+ | ‚úÖ Full support |\n| Mobile Chrome | Latest | ‚úÖ Touch support |\n| Mobile Safari | 14+ | ‚úÖ Touch support |\n\n---\n\n## API Reference\n\n### RackModule Component\n\n`tsx\n// Location\nsrc/components/smart-views/RackModule.tsx\n\n// Exports\nexport const RackModule: React.FC<RackModuleProps>\nexport const HoverScreen: React.FC<HoverScreenProps>\n\n// Dependencies\n- framer-motion (animations)\n- react (core)\n- @/lib/utils (cn function)\n- @/store/navigationStore (selectProduct)\n- @/types (Product interface)\n`\n\n### ModularRack Component\n\n`tsx\n// Location\nsrc/components/smart-views/ModularRack.tsx\n\n// Exports\nexport const ModularRack: React.FC<ModularRackProps>\n\n// Dependencies\n- framer-motion (animations)\n- react (core)\n- @/components/smart-views/RackModule\n- @/lib/utils (cn function)\n`\n\n---\n\n## Future Roadmap\n\n### v3.8.1 - Enhanced Interactions\n- [ ] Right-click context menu\n- [ ] Multi-select with Shift+click\n- [ ] Drag-to-reorder modules\n\n### v3.8.2 - Mobile Optimization\n- [ ] Touch-aware interactions\n- [ ] Swipe to browse hotspots\n- [ ] Simplified mobile layout\n\n### v3.9 - Advanced Features\n- [ ] Module customization (colors, order)\n- [ ] User preference persistence\n- [ ] Hotspot search/filter\n- [ ] Comparison mode (side-by-side)\n\n---\n\n**Document Version**: 1.0\n**Last Updated**: 2026-01-23\n**Author**: HSC-JIT Development Team\n
