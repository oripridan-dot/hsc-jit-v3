# Operations Guide - HSC-JIT v3.9.1

## System Overview

```
Production Application
    ↓
Static JSON Files (frontend/public/data/)
    ↓
React Frontend (frontend/src/)
    ↓
User Browser at http://localhost:5173
```

**Key Fact**: This is a **static-first application**. No runtime backend dependency. All data is pre-built.

---

## Starting the System

### Quick Start (Development)

```bash
cd /workspaces/hsc-jit-v3/frontend
pnpm dev
```

**Output**:

```
  VITE v7.0.0 ready in 234 ms

  ➜  Local:   http://localhost:5173/
  ➜  press h to show help
```

Open http://localhost:5173 in your browser.

### Production Build

```bash
cd /workspaces/hsc-jit-v3/frontend
pnpm build
```

**Output**: `frontend/dist/` folder (ready to deploy)

**Size**:

- JavaScript: 948 KB
- CSS: Included in bundle
- Total gzipped: ~270 KB

---

## System Architecture

### Data Pipeline

```
Backend (Data Generation - Dev Only)
├─ forge_backbone.py (main coordinator)
├─ services/
│  ├─ roland_scraper.py
│  ├─ boss_scraper.py
│  ├─ nord_scraper.py
│  └─ moog_scraper.py
└─ Outputs: frontend/public/data/*.json

    ↓

Frontend (Static App - Deployed)
├─ src/lib/
│  ├─ catalogLoader.ts (loads JSON)
│  ├─ dataNormalizer.ts (normalizes data)
│  ├─ priceFormatter.ts (formats prices)
│  └─ imageResolver.ts (resolves images)
└─ public/data/
   ├─ index.json (master index, 5,268 products)
   ├─ roland.json (500 products)
   ├─ boss.json (251 products)
   ├─ nord.json (34 products)
   └─ ... (75 other brands)
```

---

## File Organization

### Essential Files

| Path                                                    | Purpose              | Editable |
| ------------------------------------------------------- | -------------------- | -------- |
| `frontend/src/components/views/GalaxyDashboard.tsx`     | Category grid UI     | ✅       |
| `frontend/src/components/views/SpectrumModule.tsx`      | Product list UI      | ✅       |
| `frontend/src/components/views/ProductPopInterface.tsx` | Product detail modal | ✅       |
| `frontend/src/lib/catalogLoader.ts`                     | Data loading layer   | ✅       |
| `frontend/public/data/index.json`                       | Master product index | ❌       |
| `frontend/public/data/{brand}.json`                     | Brand catalogs       | ❌       |

### Generated Files (Do Not Edit)

```
frontend/public/data/
├─ index.json             ← Auto-generated by forge_backbone.py
├─ roland.json            ← Auto-generated by roland_scraper.py
├─ boss.json              ← Auto-generated by boss_scraper.py
├─ nord.json              ← Auto-generated by nord_scraper.py
└─ ... (other brands)     ← Auto-generated
```

---

## Deployment

### Option 1: Vercel (Recommended)

**Best for**: Static React apps, serverless edge functions, automatic HTTPS, zero-config deployments

```bash
# Install Vercel CLI
npm i -g vercel

# From workspace root
cd frontend
vercel --prod
```

**Result**: Your app live at `your-project.vercel.app`

### Option 2: GitHub Pages

**Best for**: Open source projects, Git-based deployments

```bash
# 1. Add to package.json
{
  "homepage": "https://yourusername.github.io/hsc-jit-v3",
  "scripts": {
    "deploy": "pnpm build && gh-pages -d dist"
  }
}

# 2. Deploy
pnpm deploy
```

### Option 3: AWS S3 + CloudFront

**Best for**: Enterprise deployments, DDoS protection, cost optimization

```bash
# Build
cd frontend && pnpm build

# Upload to S3
aws s3 sync dist/ s3://your-bucket-name/ --delete

# Invalidate CloudFront cache
aws cloudfront create-invalidation \
  --distribution-id YOUR_DISTRIBUTION_ID \
  --paths "/*"
```

### Option 4: Docker

**Best for**: Containerized deployments, on-premise servers

```dockerfile
# Dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY frontend .
RUN npm install && npm run build

FROM nginx:latest
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

```bash
docker build -t hsc-jit:latest .
docker run -p 80:80 hsc-jit:latest
```

---

## Data Updates

### Update Product Data

```bash
# 1. From workspace root
cd /workspaces/hsc-jit-v3/backend

# 2. Run the data generator
python3 forge_backbone.py
```

**What happens**:

- Runs all brand scrapers (Roland, Boss, Nord, Moog)
- Merges data from all brands
- Generates `frontend/public/data/index.json` (master index)
- Generates `frontend/public/data/{brand}.json` (per-brand catalogs)

**Redeploy**: Push new JSON files to production

```bash
cd frontend
git add public/data/*.json
git commit -m "Update product catalogs"
git push origin main
# Deployment platform auto-redeploys
```

### Add a New Brand

```bash
# 1. Create scraper
touch backend/services/mythical_scraper.py

# 2. Implement scraper
```

```python
# backend/services/mythical_scraper.py
from bs4 import BeautifulSoup
import requests

def scrape_mythical_products():
    """Scrape products from Mythical brand website"""
    url = "https://mythical-brand.com/products"
    response = requests.get(url)
    soup = BeautifulSoup(response.content, 'html.parser')

    products = []
    for item in soup.select('.product'):
        products.append({
            'id': item.get('data-id'),
            'name': item.select_one('.name').text,
            'category': item.select_one('.category').text,
            'price': float(item.select_one('.price').text.replace('$', '')),
            'image_url': item.select_one('img').get('src'),
            'description': item.select_one('.description').text
        })

    return products
```

```bash
# 3. Register in forge_backbone.py
# Edit: backend/forge_backbone.py
# Add to imports:
from services.mythical_scraper import scrape_mythical_products

# Add to scraper list:
SCRAPERS = {
    'mythical': scrape_mythical_products,
    # ... existing scrapers
}
```

```bash
# 4. Run generator
cd backend && python3 forge_backbone.py

# 5. Verify new catalog created
ls -la ../frontend/public/data/mythical.json
```

---

## Monitoring & Troubleshooting

### Check Data Integrity

```bash
# 1. Verify JSON syntax
cd frontend/public/data
for file in *.json; do
  python3 -m json.tool "$file" > /dev/null && echo "✅ $file" || echo "❌ $file"
done

# 2. Count products
node << 'EOF'
const index = require('./index.json');
console.log(`Total products: ${index.products.length}`);
console.log(`Total brands: ${Object.keys(index.brands).length}`);
EOF
```

### Check Deployed App

```bash
# 1. Verify HTML loads
curl -s https://your-app.com | head -20

# 2. Verify data loads
curl -s https://your-app.com/data/index.json | head -20

# 3. Check error logs
# For Vercel: https://vercel.com/dashboard/your-app/analytics
# For S3: CloudWatch Logs
# For Docker: docker logs <container-id>
```

### Common Issues

| Issue                                    | Cause                 | Solution                                 |
| ---------------------------------------- | --------------------- | ---------------------------------------- |
| **"Cannot find module 'catalogLoader'"** | Build hasn't run      | Run `pnpm build`                         |
| **Products showing as "N/A"**            | Price data missing    | Check `priceFormatter.ts` fallback logic |
| **Images not loading**                   | Wrong image URLs      | Check `imageResolver.ts` fallback chain  |
| **JSON parsing error**                   | Malformed JSON        | Validate with `python3 -m json.tool`     |
| **Category showing as ID**               | Component not updated | Check `ProductPopInterface.tsx`          |

### Enable Debug Mode

```typescript
// frontend/src/lib/catalogLoader.ts
// Add at top of file:
const DEBUG = true; // Change to true

// Now see detailed logs:
// "Loading brand: roland"
// "Loaded 500 products"
// "Loading category: keys"
// "Found 200 products in category keys"
```

---

## Performance Optimization

### 1. Image Optimization

**Before**: Large uncompressed JPEGs (5-10 MB per image)
**After**: Compressed WebP + JPEG fallback (200-500 KB)

```bash
# Install imagemagick
sudo apt-get install imagemagick

# Compress all images
mogrify -strip -quality 85% \
        -define webp:method=6 \
        public/data/logos/*.jpg

# Convert to WebP
for file in *.jpg; do
  convert "$file" "${file%.jpg}.webp"
done
```

### 2. Lazy Load Categories

Only load product data when user selects a category:

```typescript
// ✅ CORRECT: Load on-demand
function CategoryButton({ categoryId }) {
  const onClick = async () => {
    const products = await catalogLoader.loadProductsByCategory(categoryId);
    setProducts(products);
  };
}

// ❌ WRONG: Load everything on startup
useEffect(() => {
  const all = await catalogLoader.loadAllProducts();
  setProducts(all);
}, []);
```

### 3. Browser Caching

Configure static file caching headers:

```nginx
# nginx.conf
location /data/ {
  expires 7d;
  add_header Cache-Control "public, immutable";
}

location /js/ {
  expires 365d;
  add_header Cache-Control "public, immutable";
}

location / {
  expires 1h;
  add_header Cache-Control "public, must-revalidate";
}
```

### 4. CDN Usage

Deploy via Vercel CDN (automatic):

```
Your Server → Vercel Edge → User Browser
             (< 50ms latency)
```

Or use AWS CloudFront:

```
frontend/dist → S3 Bucket → CloudFront → User
                                        (< 30ms latency)
```

---

## Backup & Recovery

### Backup Data

```bash
# Backup JSON catalogs
tar -czf backups/data-$(date +%Y%m%d).tar.gz \
  frontend/public/data/*.json

# Backup entire codebase
tar -czf backups/codebase-$(date +%Y%m%d).tar.gz \
  --exclude node_modules \
  --exclude .git \
  .
```

### Restore Data

```bash
# List backups
ls -la backups/

# Restore specific backup
tar -xzf backups/data-20260115.tar.gz -C frontend/public/

# Redeploy
cd frontend && pnpm build && vercel --prod
```

---

## Maintenance Tasks

### Daily

- [ ] Monitor error logs (Vercel/CloudWatch)
- [ ] Check uptime (Pingdom, StatusPage)

### Weekly

- [ ] Review analytics (traffic, performance)
- [ ] Test data loading in different browsers
- [ ] Backup database/catalogs

### Monthly

- [ ] Run `forge_backbone.py` to refresh catalogs
- [ ] Update dependencies: `pnpm up`
- [ ] Security audit: `npm audit`

### Quarterly

- [ ] Performance review (Core Web Vitals)
- [ ] Accessibility audit (WCAG 2.1)
- [ ] User feedback review

---

## Useful Commands

```bash
# Development
cd frontend && pnpm dev                    # Start dev server
cd frontend && pnpm build                  # Build for production
cd frontend && pnpm preview                # Preview production build locally
cd frontend && npx tsc --noEmit           # Type check

# Testing
cd frontend && pnpm test                   # Run tests
cd frontend && pnpm test:e2e              # Run E2E tests

# Data
cd backend && python3 forge_backbone.py    # Regenerate all catalogs
cd backend && python3 run_single_brand.py  # Update single brand

# System
python3 system_architect.py                # Verify system cleanliness
python3 context_forge.py                   # Update AI context docs
```

---

## Getting Help

| Issue               | Resource                                                 |
| ------------------- | -------------------------------------------------------- |
| **Frontend setup**  | [GETTING_STARTED.md](GETTING_STARTED.md)                 |
| **Development**     | [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md)                 |
| **API methods**     | [API_REFERENCE.md](API_REFERENCE.md)                     |
| **Troubleshooting** | This guide (Troubleshooting section)                     |
| **System design**   | [docs/SYSTEM_ARCHITECTURE.md](../SYSTEM_ARCHITECTURE.md) |

---

**Status**: ✅ Production Ready | v3.9.1 | Last Updated: January 2026
